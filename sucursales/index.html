<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sucursales | Pollo Pinulito</title>
    <link rel="stylesheet" href="../css/site-wide-rules.css">
    <link rel="stylesheet" href="../css/locations-shared.css">
</head>
<body>

    <a id="skip-to-main-content" href="#main-container">Ir al contenido principal</a>
    
    <nav>
        <div id="nav-logo-container">
            <a href="/">
                <img src="../assets/img/logo.png" alt="Logo">
            </a>
        </div>
        <ul id="nav-links-container">
            <li>
                <a href="/menu/">Menu</a>
            </li>
            <li>
                <a class="nav-selected" href="/sucursales/">Sucursales</a>
            </li>
            <li>
                <a href="/eventos/">Eventos</a>
            </li>
        </ul>
    </nav>

    <div id="main-container">
        <h1 class="not-visible">Sucursales de Pollo Pinulito</h1>

        <div id="locations-outer-container">
            <h2>TODAS NUESTRAS SUCURSALES</h2>
        </div>
        <div id="locations-actual-container">
            <h4>Departamentos</h4>
            <ul class="sucursales-list">

                <template id="sucursal_location_dep">
                    <li>
                        <a class="sucursal-url" href="#">
                            <span class="sucursal-location"></span>
                            <span class="sucursales-count"></span>
                        </a>
                    </li>
                </template>

            </ul>
        </div>

        <footer>
            <div class="footer-sections-container">
                <div class="footer-section-container">
                    <h4>Nuestra comida</h4>
                    <ul>
                        <li>
                            <a href="/menu/">Menu</a>
                        </li>
                        <li>
                            <a href="/sucursales/">Sucursales</a>
                        </li>
                        <li>
                            <a href="/eventos/">Pinulito para eventos</a>
                        </li>
                    </ul>
                </div>
                <div class="footer-section-container">
                    <h4>Sigamos en contacto</h4>
                    <ul>
                        <li>
                            <a href="#">Facebook</a>
                        </li>
                        <li>
                            <a href="#">Instagram</a>
                        </li>
                        <li>
                            <a href="#">Contáctanos</a>
                        </li>
                    </ul>
                </div>
            </div>
        </footer>

    </div>

    <script>

        let sucursalesUl;

        let sucursalesDic = {
            'ahuachapan': 'Ahuachapán',
            'cabanas': 'Cabañas',
            'chalatenango': 'Chalatenango',
            'cuscatlan': 'Cuscatlán',
            'la-libertad': 'La Libertad',
            'la-paz': 'La Paz',
            'la-union': 'La Unión',
            'morazan': 'Morazán',
            'san-miguel': 'San Miguel',
            'san-salvador': 'San Salvador',
            'san-vicente': 'San Vicente',
            'sana-ana': 'Santa Ana',
            'sonsonate': 'Sonsonate',
            'usulutan': 'Usulutan',
        }

        window.onload = function() {

            sucursalesUl = document.getElementsByClassName('sucursales-list')[0];

            fetch('/_data/merged/sucursales_merged.json')
            .then(response => response.json())
            .then(data => {
                handleSucuesalesRender(data);
            })
            .catch(err => {
                console.error(err);
            })
        }

        function handleSucuesalesRender(sucursalesDetails) {

            let sucursales = [];
            let sucursalesKeys = Object.keys(sucursalesDetails);

            for(let i = 0; i < sucursalesKeys.length; i++){
                if(sucursalesDetails[sucursalesKeys[i]].length > 0){
                    sucursales.push({
                        name: sucursalesDic[sucursalesKeys[i]],
                        url: `/sucursales/${sucursalesKeys[i]}/`,
                        count: sucursalesDetails[sucursalesKeys[i]].length
                    })
                }
            }

            sucursales.forEach(sucursalDep => {
                let liElement = document.getElementById('sucursal_location_dep');

                let aElement = liElement.content.querySelector('.sucursal-url');
                    aElement.href = sucursalDep.url;

                let locElement = liElement.content.querySelector('.sucursal-location');
                    locElement.innerText = sucursalDep.name;
                
                let countElement = liElement.content.querySelector('.sucursales-count');
                    countElement.innerText = ` (${sucursalDep.count})`;

                let clone = document.importNode(liElement.content, true);
                sucursalesUl.appendChild(clone);
            });
        }

    </script>

</body>
</html>